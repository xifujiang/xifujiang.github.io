<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    
    
    
    <title>小西芙-沿着回忆我走过旧时光 | 小西芙-沿着回忆我走过旧时光</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    
    <meta name="theme-color" content="#77AAFF">
    
    
    <meta name="keywords" content="xifujiang">
    
    

    

    <!-- Baidu Push -->
<script>
	(function(){
		var bp = document.createElement('script');
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	})();

	var _hmt = _hmt || [];
</script>



    
    <meta name="description" content="呢嚎哟，介里是小西芙的小小博客，请多多关照。顺便说一句夕立立永远是我儿贼！！~">
<meta name="keywords" content="xifujiang">
<meta property="og:type" content="website">
<meta property="og:title" content="小西芙-沿着回忆我走过旧时光">
<meta property="og:url" content="https://xifujiang.github.io/index.html">
<meta property="og:site_name" content="小西芙-沿着回忆我走过旧时光">
<meta property="og:description" content="呢嚎哟，介里是小西芙的小小博客，请多多关照。顺便说一句夕立立永远是我儿贼！！~">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小西芙-沿着回忆我走过旧时光">
<meta name="twitter:description" content="呢嚎哟，介里是小西芙的小小博客，请多多关照。顺便说一句夕立立永远是我儿贼！！~">
    
        <link rel="alternate" type="application/atom+xml" title="小西芙-沿着回忆我走过旧时光" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/icon.ico">
    <link id="style" rel="stylesheet" href="/css/style.css?v=3.0">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    
            
</head>

<body>
    <div id="loading" class="active"></div>
    <aside id="menu">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/timg.png" alt="avatar">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname" id="name">xifujiang</h5>
          
            <div id="yiyanmotto" class="motto">&nbsp;</div>
          
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
              <li class="waves-block waves-effect active">
                  <a href="/">
                    <i class="icon icon-lg icon-home"></i>
                    <span>主 页</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/archives">
                    <i class="icon icon-lg icon-archives"></i>
                    <span>归 档</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/categories">
                    <i class="icon icon-lg icon-th-list"></i>
                    <span>分 类</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/tags">
                    <i class="icon icon-lg icon-tags"></i>
                    <span>标 签</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/about">
                    <i class="icon icon-lg icon-smile-o"></i>
                    <span>关 于</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
      <div class="nav2">
          
              <a class="nav2item" data-title="Email" href="/229694302@qq.com" target="_parent" title="Email">
                <i class="icon icon-lg icon-envelope-o envelope-o"></i>
              </a>
          
              <a class="nav2item" data-title="Github" href="https://github.com/xifujiang" target="_blank" title="Github">
                <i class="icon icon-lg icon-github github"></i>
              </a>
          
              <a class="nav2item" data-title="微博" href="https://www.weibo.com/xifujiang/home?wvr=5&lf=reg" target="_blank" title="微博">
                <i class="icon icon-lg icon-weibo weibo"></i>
              </a>
          

            </div>
        
      </ul>
        
    </div>
  </div>
 
</aside>


    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">小西芙-沿着回忆我走过旧时光</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        <a href="../../atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" id="Rss">
            <i class="icon icon-lg icon-rss"></i>
        </a>
    </div>
</header>
<header class="content-header index-header">
    
    
    <div class="container fade-scale">
        <div id="myheader">
            <h1 class="title">
                 
                    小西芙-沿着回忆我走过旧时光
                
            </h1>
            <h5 class="subtitle">
                
                    小西芙想做机器人鸭
                
            </h5>
        </div>
    </div>

</header>

<div class="container body-wrap">
    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-02 HDFS上传和读取流程" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/undefined/">02 HDFS上传和读取流程</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-03-28 14:34:00" datetime="2019-03-28T06:34:00.000Z" itemprop="datePublished">2019-03-28</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h3 id="上传流程"><a href="#上传流程" class="headerlink" title="上传流程"></a>上传流程</h3><ul>
<li>1.根namenode通信请求上传文件，namenode检查目标文件是否已存在，父目录是否存在。</li>
<li>2.namenode返回是否可以上传</li>
<li>3.client请求第一个 block该传输到哪些datanode服务器上</li>
<li>4.namenode返回3个datanode服务器ABC</li>
<li>5.client请求3台dn中的一台A上传数据（本质上是一个RPC调用，建立pipeline），A收到请求会继续调用B，然后B调用C，将这个pipeline建立完成，逐级返回客户端</li>
<li>6.client开始往A上传第一个block（先从磁盘读取数据放到一个本地内存缓存），以packet为单位，A收到一个packet就会传给B，B传给C；A每传一个packet会放入一个应答队列等待应答</li>
<li>7.当一个block传输完成之后，client再次请求namenode上传第二个block的服务器。<h3 id="读取流程"><a href="#读取流程" class="headerlink" title="读取流程"></a>读取流程</h3>客户端读取HDFS数据相比写入数据要简单一些，以下是读取数据步骤：</li>
<li>1.client访问NameNode，查询元数据信息，获得这个文件的数据块位置列表，返回输入流对象。</li>
<li>2.就近挑选一台datanode服务器，请求建立输入流。</li>
<li>3.开始读取这个数据的第一个block块，读取完全之后，开始接着读取这个文件的第二个block，直至把这个数据所有的block都读完了则文件读取完全了。</li>
<li>4.数据读完之后关闭流连接。</li>
<li>5.如果读取过程当中读取失败，将会依次读取该数据块的下一个副本，失败的节点将会被记录，不再连接。</li>
</ul>
<p>￼# SecondaryNameNode<br>SecondaryNameNode 是 HDFS 架构中的一个组成部分，它用来保存名称节点中对HDFS元数据信息的备份，减小Editlog文件大小，从而缩短名称节点重启的时间。 它一般是单独运行在一台机器上。 SecondaryNameNode让EditLog变小的工作流程如下: </p>
<ul>
<li>(1)SecondaryNameNode 会定期和 NameNode 通信，请求其停止使用 EditLog 文件，暂时将 新的写操作写到一个新的文件 edit.new 中，这个操作是瞬间完成的，上层写日志的函数完全感觉不到差别。 </li>
<li>(2) SecondaryNameNode 通过 HTTP GET 方式从 NameNode 上获取到 Fslmage 和 EditLog 文 件，井下载到本地的相应目录下。 </li>
<li>(3) SecondaryNameNode 将下载下来的 Fslmage 载入到内存，然后一条一条地执行 EditLog 文件中的各项更新操作，使内存中的 Fslmage 保持最新。 这个过程就是 EditLog 和 Fslmage 文件合 井。 </li>
<li>(4) SecondaryNameNode 执行完（3）操作之后，会通过 post 方式将新的 Fslmage 文件发送 到 NameNode 节点上</li>
<li>(5) NameNode 将从 SecondaryNameNode 接收到的新的 Fslmage 替换旧的 Fslmage 文件，同 时将 Edit.new 替换 EditLog 文件，从而减小 EditLog 文件大小。<br>￼<br>从上面的过程可以看出，第二名称节点相当于为名称节点设置一个“检查点” ，周期性备份 名称节点中的元数据信息，但第二名称节点在 HDFS 设计中只是一个冷备份，并不能起到“热备 份”的作用。 HDFS 设计并不支持当名称节点故障时直接切换到第二名称节点。</li>
</ul>
<p>HDFS Federation<br>HDFSl.O 的单 NameNode 设计不仅存在单点故障问题，还存在可扩展性和性能问题。只有一 个 NameNode， 不利于水平扩展。 HDFS Federation (HDFS 联邦）特性允许一个 HDFS 集群中存在 多个 NameNode 同时对外提供服务，这些 NameNode 分管一部分目录（水平切分），彼此之间相 互隔离，但共享底层的 DataNode 存储资源。每个 NameNode 是独立的，不需要和其他 Nam巳Node 协调合作。 如图 4-5 所示 ， Federation 使用了 多 个独立的 NameNode/NameSpace 命名空间。这些 NameNode 之间是联合的，也就是说， 它们之间相互独立且不需要互相协调，各自分工管理自己的 区域。分布式的 DataNode 被用作通用的数据块存储设备。每个 DataNode 要向集群中所有的 NameNode 注册，且周期性地向所有 NameNode 发送心跳和块报告， 并执行来自所有 NameNode 的命令。每一个 DataNode 作为统一的块存储设备被所有 NameNode 节点使用。 每一个 DataNode 节点都在所有的 NameNode 进行注册。 DataNode 发送心跳信息、块报告到 所有 NameNode，同时执行所有 NameNode 发来的命令。<br>￼</p>

    
        <div class="post-more-div">
            <a href="/posts/undefined/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-01 .bat批量把txt中想要的信息存放到excel" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/undefined/">01 .bat批量把txt中想要的信息存放到excel</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-03-28 14:34:00" datetime="2019-03-28T06:34:00.000Z" itemprop="datePublished">2019-03-28</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>最近喵仙子有个需求，需要抽取大量.log文件中的有效信息到excel，刚开始我用mapreduce给他做了一份，不过他有点蠢配不了环境，于是乎我研究了下bat，终于给他整了个好方法，请看下文。</p>
<p><code>需求</code></p>
<p>需要从log中抽取两列数据到excel中。</p>
<p>本西芙没了解过bat语法，所以查了一下，通过结合这两篇解答完成bat命令。<br>1、实现了按照空格批处理分割txt数据，存储excel<br><a href="https://zhidao.baidu.com/question/1770548208106936980.html" target="_blank" rel="noopener">https://zhidao.baidu.com/question/1770548208106936980.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">rem 保存为bat文件跟txt文件放一起运行</span><br><span class="line">md &quot;结果\&quot; 2&gt;nul</span><br><span class="line">for /f &quot;delims=&quot; %%a in (&apos;dir /a-d/b *.txt&apos;) do (</span><br><span class="line">    setlocal EnableDelayedExpansion</span><br><span class="line">    (for /f &quot;delims=&quot; %%b in (&apos;type &quot;%%a&quot;&apos;) do (</span><br><span class="line">        set &quot;str=%%b&quot;</span><br><span class="line">        echo;!str: =,!</span><br><span class="line">    ))&gt;&quot;结果\%%~na.csv&quot;</span><br><span class="line">    Endlocal</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></p>
<p>2、批处理分割字符串<br><a href="https://blog.csdn.net/zhju85126com/article/details/46649961" target="_blank" rel="noopener">https://blog.csdn.net/zhju85126com/article/details/46649961</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set str=100x200x300y400y500x600y700</span><br><span class="line">for /f &quot;tokens=1,3-5,* delims=x|y&quot; %%a in (&quot;%str%&quot;) do (</span><br><span class="line">	set c1=%%a</span><br><span class="line">	set c3=%%b</span><br><span class="line">	set c4=%%c</span><br><span class="line">	set c5=%%d</span><br><span class="line">	set c6=%%e</span><br><span class="line">)</span><br><span class="line">echo %c1%, %c3%, %c4%, %c5%, %c6%</span><br><span class="line">pause</span><br><span class="line">rem 输出结果为输出结果为：100, 300, 400, 500, 600y700。其中tokens=1,3-5,*表示提取第1、3至5列，同时把第5列后所有剩余字符串作为第6列，一个输出了5个变量，也可以写作tokens=1,3,4,5,*。</span><br></pre></td></tr></table></figure></p>
<p>最终我所加工的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">md &quot;结果\&quot; 2&gt;nul</span><br><span class="line">rem 循环数据</span><br><span class="line">for /f &quot;delims=&quot; %%a in (&apos;dir /a-d/b *.log&apos;) do (</span><br><span class="line">    setlocal EnableDelayedExpansion</span><br><span class="line">    rem 切割方式    </span><br><span class="line">    (for /f &quot;tokens=7,25 delims=_| &quot; %%b in (&apos;type &quot;%%a&quot;&apos;) do (</span><br><span class="line">        set &quot;str1=%%b %%c&quot;</span><br><span class="line">        echo;!str1: =,!</span><br><span class="line">    ))&gt;&quot;结果\%%~na.csv&quot;</span><br><span class="line">    Endlocal</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></p>
<p>首先根据第一篇解答套入转excel模板，其次根据第二篇解答对bat for循环中分割和选取的描述，修改第五行代码。可以实现。</p>
<p>###演示<br>1、双击bat<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20190429153738614/20190429033933251.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>2、生成结果</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20190429153738614/20190429034009201.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<p>3、查看生成数据（完成）</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20190429153738614/20190429034033093.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
    
        <div class="post-more-div">
            <a href="/posts/undefined/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-04 python爬虫笔记" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/undefined/">04 python爬虫笔记</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-03-28 14:34:00" datetime="2019-03-28T06:34:00.000Z" itemprop="datePublished">2019-03-28</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h3 id="爬虫如何抓取网页数据"><a href="#爬虫如何抓取网页数据" class="headerlink" title="爬虫如何抓取网页数据"></a>爬虫如何抓取网页数据</h3><p>网页三大特征：<br>1、网页都有自己的唯一的URL（统一资源定位符）来进行定位。<br>2、网页都使用HTML(超文本标记语言)来描述页面信息。<br>3、网页都使用HTTP/HTTPS(超文本传输协议)协议来传输HTML数据。</p>
<p>爬虫的设计思路<br>1、首先确定需要爬取的网页URL地址。<br>2、通过HTTP/HTTP协议协议来获取对应的HTML页面。<br>3、提取HTML页面里有用的数据：<br>    a.如果是需要的数据，就保存起来。<br>    b.如果是页面里的其他URL，那就继续执行第二步。</p>
<p>#为什么选择Python做爬虫？<br>PHP：是世界上最好的语言，但他天生不是干爬虫的，对多线程，异步支持不够好。爬虫是工具性程序，对速度和效率的要求比较高。<br>Java爬虫生态圈很完善，是Python爬虫最大的对手。但是Java语言本身很笨重，代码量很大。爬虫经常需要修改部分采集代码，所以Java不合适。<br>C/C++运行效率和性能几乎最强，但是学习成本很高。代码成型比较慢。能用C/C++做爬虫，只能说是能力的表现，但不是正确的选择。<br>Python语法优美、代码简介、开发效率高、支持的模块多，相关HTTP请求模块<br>还有强大的爬虫Scrapy，以及成熟高效的scrapy-redis分布式策略。<br>而且，调用其他接口也非常方便（胶水语言）</p>
<h3 id="如何抓取HTML页面："><a href="#如何抓取HTML页面：" class="headerlink" title="如何抓取HTML页面："></a>如何抓取HTML页面：</h3><pre><code>HTTP请求的处理，urllib、urllib2、requests
处理后的请求可以模拟浏览器发送请求，获取服务器响应的文件
</code></pre><p>#解析服务器响应的内容<br>    re、xpath、BeautifulSoup4（bs4）、jsonpath、pyquery等<br>    使用某种描述性一样来给我们需要提取的数据定义一个匹配规则<br>    符合这个规则的数据就会被匹配</p>
<p>#如何采集动态HTML、验证码的处理<br>    通过动态页面采集，Selenium+PhantomJS(无界面)：模拟真实浏览器加载js、ajax等非静态的数据。<br>    Tesseract：机器学习库，机器图像识别系统，可以处理简单的验证码，复杂的验证码可以通过手动输入/专门的打码平台。<br>    sccrapy框架：（Scrapy，Pyspider）<br>        搞定制性高性能（异步网络框架 twisterd），所以数据下载速度非常快，提供了数据存储、数据下载、提取规则等组件。<br>    分布式策略：scrapy-redis，在Scrapy的基础上添加了一套以Redis数据库为核心的一套组件。让Scrapy框架支持分布式的功能。主要在Redis里做请求指纹去重、请求分配、数据临时存储。</p>
<h3 id="爬虫–反爬虫–反反爬虫-之间的斗争："><a href="#爬虫–反爬虫–反反爬虫-之间的斗争：" class="headerlink" title="爬虫–反爬虫–反反爬虫 之间的斗争："></a>爬虫–反爬虫–反反爬虫 之间的斗争：</h3><pre><code>其实怕重做到最后，最头疼的不是复杂的页面，也是灰色的数据，而是网站另一边的反爬虫人员。
User-Agent、代理、验证码、动态数据加载、加密数据。
数据价值、是否值的去费劲做反爬虫。
1. 机器成本 + 人力成本 &gt; 数据价值，就不反了，一般做到封IP就结束了。
2、面子的战争......
爬虫和反爬虫之间的斗争，最后一定是爬虫获胜。
为什么？只要是真实用户可以浏览的网页数据，爬虫就一定能爬下来！
</code></pre><p>#根据使用场景 分为 ：通用爬虫  聚焦爬虫<br>1通用爬虫：搜索引擎用的爬虫系统。<br>1、目标：就是尽可能吧互联网上所有的网页下载下来，放到本地服务器里形成备份；<br>    再对这些网页做相关处理（提取关键字、去掉广告），最后提供一个用户检索接口。<br>2、抓取流程：<br>    a） 首选选取一部分已有的URL，把这些URL放到待爬取队列。<br>    b） 从队列里取出这些URL，然后解析DNS得到主机IP，然后去这个IP对应的服务器里下载HTML页面，保存到搜索引擎的本地服务器。之后把这个爬过的URL放入已爬取队列。<br>    c）分析这些网页内容，找出网页里其他的URL链接，继续执行第二步，直到爬取条件结束。<br>3、搜索引擎如何获取一个新网站的URL:<br>    A).主动向搜索引擎提交网址,<br>    B).向其他网站里设置网站的外链。<br>    C).搜索引擎会和DNS服务商进行合作，可以快速收录新的网站。<br>    <code>DNS：就是把域名解析成IP的一种技术。</code><br>4、通用爬虫并不是万物皆可爬，它也需要遵守规则：<br>Robots协议：协议会指明通用爬虫可以爬取网页的权限。<br>Robots.txt 只是一个建议。并不是所有爬虫都遵守，一般只有大型的搜索引擎爬虫才会遵守。咱们个人写的爬虫，就不用管了。<br>5、通用爬虫工作流程：爬取网页 - 存储数据 - 内容处理 - 提供检索/排名服务<br>6、搜索引擎排名：<br>    ·PageRank值：根据网站的流量（点击量/浏览量/人气）统计，流量越高，网站越值钱，排名越靠前。<br>    ·竞价排名：谁给钱多，谁排名就高。<br>7、通用爬虫的缺点：<br>    1、只能提供和文本相关的内容（HTML、Word、PDF）等等，但是不能提供多媒体（音乐、图片、视频）和二进制文件（程序、脚本）等。<br>    2、提供的结果千篇一律，不能针对不同背景领域的人提供不同的搜索结果。<br>    3、不能理解人类语义上的检索。</p>
<p>2聚焦爬虫：爬虫程序员写的针对某种内容爬虫。<br>面向主题爬虫、面向需求爬虫：会针对某种特定的内容去爬取信息，而且会保证信息和需求息息相关。</p>
<p>http的端口号：80；<br>https的端口是：443；</p>
<p>Python自带的模块：/usr/lib/python2.7/urllib2.py</p>
<p>Python的第三方模块： /usr/local/lib/python2.7/site-packages</p>
<p>urllib2 默认的 User-Agent：Python-urllib/2.7</p>
<p>User-Agent: 是爬虫和反爬虫斗争的第一步，养成好习惯，发送请求带User-Agent</p>
<p>response 是服务器响应的类文件，除了支持文件操作的方法外，还支持以下常用的方法：</p>
<p><em>返回 HTTP的响应码，成功返回200，4服务器页面出错，5服务器问题</em></p>
<p>print response.getcode()</p>
<p><em>返回 返回实际数据的实际URL，防止重定向问题</em><br>print response.geturl()</p>
<p><em>返回 服务器响应的HTTP报头</em><br>print response.info()</p>
<h3 id="User-Agent-历史："><a href="#User-Agent-历史：" class="headerlink" title="User-Agent 历史："></a>User-Agent 历史：</h3><ul>
<li>Mosaic 世界上第一个浏览器：美国国家计算机应用中心</li>
<li>Netscape 网景：Netscape（支持框架），慢慢开始流行….(第一款支持框架的浏览器)</li>
<li>Microsoft 微软：Internet Explorer（也支持框架）</li>
<li>第一次浏览器大战：网景公司失败..消失</li>
<li>Mozilla 基金组织：Firefox 火狐 - （Gecko内核）(第一款浏览器内核)</li>
<li>User-Agent 决定用户的浏览器，为了获取更好的HTML页面效果。</li>
<li>IE开了个好头，大家都开就给自己披着了个 Mozilla 的外皮</li>
<li>Microsoft公司：IE（Trident）</li>
<li>Opera公司：Opera（Presto）</li>
<li>Mozilla基金会：Firefox（Gecko）</li>
<li>Linux组织：KHTML （like Gecko）</li>
<li>Apple公司：Webkit（like KHTML）</li>
<li>Google公司：Chrome（like webkit）</li>
<li>其他浏览器都是IE/Chrome内核</li>
</ul>
<h2 id="Scrapy架构图（绿线是数据流向）："><a href="#Scrapy架构图（绿线是数据流向）：" class="headerlink" title="Scrapy架构图（绿线是数据流向）："></a>Scrapy架构图（绿线是数据流向）：</h2><p>ScrapyEngine（引擎）：负责通讯，信号、数据传递</p>
<h3 id="制作Scrapy爬虫-四步骤："><a href="#制作Scrapy爬虫-四步骤：" class="headerlink" title="制作Scrapy爬虫 四步骤："></a>制作Scrapy爬虫 四步骤：</h3><ul>
<li>新建项目（scrapy startproject xxx）:新建一个新的爬虫项目</li>
<li>明确目标（编写items.py）：明确你想要爬取的目标</li>
<li>制作爬虫（spiders/xxspider.py）：制作爬虫开始爬取网页</li>
<li>存储内容（pipelines.py）：设计管道存储爬取内容</li>
</ul>
<p>创建爬虫项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#创建普通项目</span><br><span class="line">scrapy startproject 项目名</span><br><span class="line">#创建模板</span><br><span class="line">scrapy startproject 项目名  网站名</span><br></pre></td></tr></table></figure></p>

    
        <div class="post-more-div">
            <a href="/posts/undefined/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-03 python入门笔记" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/undefined/">03 python笔记</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-03-28 14:34:00" datetime="2019-03-28T06:34:00.000Z" itemprop="datePublished">2019-03-28</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>1、ipython命令技能实现python命令，也能实现部分linux命令。<br>2、python2不能识别文件里的中文，如果硬要识别，在头文件中加上 -<em>- coding:utf-8 -</em>- （python官方推荐这种方式）<br>3、输入一个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">high = input(&quot;请输入一个数&quot;)</span><br></pre></td></tr></table></figure></p>
<p>4、输出一个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">age = 18</span><br><span class="line">print(&quot;age的值为%d&quot;%age)</span><br><span class="line">name = &quot;西芙&quot;</span><br><span class="line">print(&quot;name的值为%s&quot;%name);</span><br><span class="line">print(&quot;name的值是%s,年龄的值是%d&quot;%(name,age))</span><br></pre></td></tr></table></figure></p>
<p>4、if else语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">age = 19</span><br><span class="line">if age&gt;18:</span><br><span class="line">    print(&quot;已经成年&quot;)</span><br><span class="line">else</span><br><span class="line">    print(&quot;未成年&quot;)</span><br><span class="line">#input获取的所有数据都会当成字符串类型</span><br><span class="line">#python 规定 str（）&gt;int()</span><br><span class="line">#所以如果 age  = input(&quot;一个值&quot;)</span><br><span class="line">#要与int比较，需要把age换成int类型，即</span><br><span class="line">#age_num = int(age)</span><br></pre></td></tr></table></figure></p>
<p>5、python语言是弱类型的编程语言，及赋值的时候已经知道是什么类型<br>6、查看变量类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(a)</span><br></pre></td></tr></table></figure></p>
<p>7、python的变量类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">·Numbers(数字)： int(有符号整型)，long（长整型[也可代表八进制和十六进制]），float（浮点型），complex（复数）</span><br><span class="line">·布尔类型： True，False</span><br><span class="line">·String（字符串）</span><br><span class="line">·List（列表）</span><br><span class="line">·Tuple（元组）</span><br><span class="line">·Dictionary（字典）</span><br></pre></td></tr></table></figure></p>
<p>8、关键字<br>￼<br>查看关键字命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import keyword #导入keyword包</span><br><span class="line">keyword.kwlist</span><br></pre></td></tr></table></figure></p>
<p>9、运算符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;s&quot;*10</span><br><span class="line">#输出&apos;ssssssssss&apos;</span><br><span class="line"></span><br><span class="line">#幂</span><br><span class="line">#**</span><br></pre></td></tr></table></figure></p>
<p>10、is是地址相同的意思，在数值-5到256间，a与b地址相同，其余不同<br>￼<br>11、深拷贝与浅拷贝<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#例1、浅拷贝</span><br><span class="line">a = [11, 22, 33]</span><br><span class="line">b = a #浅拷贝，地址拷贝，地址相同</span><br><span class="line"></span><br><span class="line">#例2、深拷贝</span><br><span class="line">import copy</span><br><span class="line">c = copy.deepcopy(a) #开辟一个内存空间，拷贝内容</span><br><span class="line"></span><br><span class="line">#例3、在数组中，深拷贝数组后，</span><br><span class="line">a = [11,22,33]</span><br><span class="line">b = [44,55,66]</span><br><span class="line">c = [a, b]</span><br><span class="line">d = copy.deepcopy[c]</span><br><span class="line">#查看c，d的id，并不相同，深拷贝</span><br><span class="line">#在a数组中添加[44],查看c[0],d[0]</span><br><span class="line">a.append(44)</span><br><span class="line">c[0]</span><br><span class="line">[11,22,33,44]</span><br><span class="line">d[0]</span><br><span class="line">[11,22,33]</span><br><span class="line">#说明深拷贝后，d另外拷贝了有关a、b的拷贝</span><br><span class="line"></span><br><span class="line">#例4、有关指向a，b的拷贝</span><br><span class="line">e = copy.copy(c)</span><br><span class="line">a.append(55)</span><br><span class="line">c[0]</span><br><span class="line">e[0]</span><br><span class="line">#所看到的结果都是[11,22,33,44,55]</span><br><span class="line">id(c)</span><br><span class="line">id(e)</span><br><span class="line">#所看到的地址不同，所以他们是指向不同的地址但所指向数组的内容地址是相同的</span><br><span class="line">#但如果是c = (a,b)，是元组的话，由于元组是不可变类型，e = copy.copy(c),他们所指向的地址是一样的</span><br><span class="line">#所以使用copy模块的copy功能时候，它会根据当前拷贝的数据类型是可变类型还是不可变类型有不同的处理方式</span><br></pre></td></tr></table></figure></p>
<p>12、私有化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Test(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.__num = 100</span><br><span class="line">    def setNum(self, newNum):</span><br><span class="line">        self.__num = newNum</span><br><span class="line">    def getNum(self):</span><br><span class="line">        return self.__num</span><br><span class="line">t = Test()</span><br><span class="line">t.__num = 200 #可以使用</span><br><span class="line">print(t.__num)</span><br></pre></td></tr></table></figure></p>
<p>升级版私有化 property使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Test(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.__num = 100</span><br><span class="line">    def setNum(self, newNum):</span><br><span class="line">        self.__num = newNum</span><br><span class="line">    def getNum(self):</span><br><span class="line">        return self.__num</span><br><span class="line">    num = property(getNum, setNum)#!!!!</span><br><span class="line">#此时，可以用t.num = ?赋值 或者 t.num 取值，不用调用函数</span><br></pre></td></tr></table></figure></p>
<p>装饰器使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Test(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.__num = 100</span><br><span class="line">    @property    </span><br><span class="line">    def num(self):</span><br><span class="line">        return self.__num</span><br><span class="line">    @num.setter    </span><br><span class="line">    def num(self, newNum):</span><br><span class="line">        self.__num = newNum</span><br><span class="line">#与上面的代码意思相同。理解一下吧~</span><br></pre></td></tr></table></figure></p>
<p>1、xx:公有变量<br>2、<em>x:单前置下划线，私有化属性或方法，from somemodule import * 禁止导入，类对象和子类可以访问<br>3、__x</em>:双前置下划线，避免与子类中的属性命名冲突，无法在外部直接访问（名字重整所以访问不到）<br>4、<strong>x</strong>：双前后下划线，用户名字空间的魔法对象或属性。例如<strong>init</strong>,__不要自己发明这样的名字<br>5、xx_:单后置下划线，用于避免与python关键词的冲突</p>
<p>###但是私有属性实际上是可以访问，python把私有属性的名字由原来的<strong>_私有属性名 改成  _类名</strong>私有属性名，所以可以通过对象._类名__私有属性名可以获取值！！！</p>
<p>13、迭代器<br><code>迭代器
迭代器是访问集合元素的一种方式，迭代器是一个可以记住遍历的位置的对象。迭代器对象从集合的第一个元素开始访问，知道所有的元素被访问完结束。迭代器只能往前不会后退。</code><br><code>可迭代对象：
可直接作用于for循环的数据类型有以下几种：
一类是集合数据类型：如list、tuple、dict、set、str等
一类是generator，包括生成器和带yield的generator function。
可以直接作用于for循环的对象统称为可迭代对象：Iterable。</code></p>
<p>14、闭包：定义：函数里面有另外的函数，并且里面的函数用到了外面的函数的变量<br>闭包的应用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def test(number):</span><br><span class="line">    print(&quot;--1--&quot;)</span><br><span class="line">    def test_in(number2):</span><br><span class="line">        print(&quot;--2--&quot;)</span><br><span class="line">        print(number+number2)</span><br><span class="line">    print(&quot;--3--&quot;)</span><br><span class="line">    return test_in</span><br><span class="line">    </span><br><span class="line">ret = test(100)</span><br><span class="line">print(&quot;-&quot;*30)</span><br><span class="line">ret(1)</span><br><span class="line">ret(100)</span><br><span class="line">ret(200)</span><br><span class="line">#优点 简化了步骤</span><br></pre></td></tr></table></figure></p>
<p><code>linux快捷键： %s/^/#/g  所有行前面加#  1,14/#//g 去掉1-14行的#</code><br>15、装饰器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def w1(func):</span><br><span class="line">    def inner():</span><br><span class="line">        print(&quot;----正在验证权限---&quot;)</span><br><span class="line">        func()</span><br><span class="line">    return inner</span><br><span class="line">def f1():</span><br><span class="line">    print(&quot;---f1---&quot;)</span><br><span class="line">def f2():</span><br><span class="line">    print(&quot;---f2---&quot;)</span><br><span class="line"></span><br><span class="line">#innerFunc = w1(f1)</span><br><span class="line">#innerFunc()</span><br><span class="line"></span><br><span class="line">f1 = w1(f1)    #把w1（f1）赋值给f1，也就是说f1 = w1.inner，f1指向的就是inner这个函数</span><br><span class="line">f1()   #调用后，执行的是inner，但由于之前传入f1的参数，所以输出结果为inner的输出结果+f1函数的输出结果</span><br><span class="line"></span><br><span class="line">@w1 #与上面f1=w1(f1)意义相同，但只要python执行器执行到了这个代码，name就会自动的进行装饰，而不是等到调用的时候才装饰的  语法糖 @w1</span><br><span class="line">def f1():</span><br><span class="line">    print(&quot;---f1---&quot;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#若有参数</span><br><span class="line">def func(functionName):</span><br><span class="line">    print(&quot;---func---1---&quot;)</span><br><span class="line">    def func_in(*args, **kwargs):#如果没有定义参数，会导致调用的时候出现问题</span><br><span class="line">        print(&quot;---func_in---1---&quot;)</span><br><span class="line">        functionName(*args, **kwargs)#传入同样的参数</span><br><span class="line">        print(&quot;---func_in---2---&quot;)      </span><br><span class="line">    print(&quot;---func---2---&quot;)</span><br><span class="line">    return func_in</span><br><span class="line">@func</span><br><span class="line">def test(a, b, c):</span><br><span class="line">    print(&quot;---test-a=%d,b=%d,c=%d---&quot;%(a,b,c))</span><br><span class="line">    </span><br><span class="line">@func</span><br><span class="line">def test2(a, b, c, d):</span><br><span class="line">    print(&quot;---test-a=%d,b=%d,c=%d,d=%d---&quot;%(a,b,c,d))</span><br><span class="line"></span><br><span class="line">test(11,22,33)</span><br><span class="line">test2(44,55,66,77)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#通用装饰器</span><br><span class="line">def func(functionName):</span><br><span class="line">    def func_in(*args, **kwargs):</span><br><span class="line">        print(&quot;---记录日志---&quot;)</span><br><span class="line">        ret = functionName(*args, **kwargs)</span><br><span class="line">        return ret</span><br><span class="line">    return func_in</span><br><span class="line"></span><br><span class="line">@func</span><br><span class="line">def test():</span><br><span class="line">    print(&quot;---test---&quot;)</span><br><span class="line">    return &quot;haha&quot;</span><br><span class="line"></span><br><span class="line">@func</span><br><span class="line">def test2():</span><br><span class="line">    print(&quot;---test2---&quot;)</span><br><span class="line"></span><br><span class="line">@func</span><br><span class="line">def test3(a):</span><br><span class="line">    print(&quot;---test3---a=%d--&quot;%a)</span><br><span class="line">    </span><br><span class="line">ret = test()</span><br><span class="line">print(&quot;test return value is %s&quot;%ret)</span><br><span class="line"></span><br><span class="line">a = test2()</span><br><span class="line">print(&quot;test2 return value is %s&quot;%a)</span><br><span class="line"></span><br><span class="line">test3(11)</span><br></pre></td></tr></table></figure>
<p>16、作用域</p>
<p>#什么是命名空间<br>在某个范围内所能用到的作用域</p>
<p>17、类方法与静态方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#给类添加方法</span><br><span class="line">import types #导入types包</span><br><span class="line">class Person(object):</span><br><span class="line">    def __init__(self, newName, newAge):</span><br><span class="line">        self.name = newName</span><br><span class="line">        self.age = newAge</span><br><span class="line">    </span><br><span class="line">    def eat(self):</span><br><span class="line">        print(&quot;-----%s正在吃----&quot;%self.name)</span><br><span class="line"></span><br><span class="line">def run(self):</span><br><span class="line">    print(&quot;-----%s正在跑----&quot;%self.name)</span><br><span class="line">    </span><br><span class="line">p1 = Person(&quot;p1&quot;, 10)</span><br><span class="line">p1.eat()</span><br><span class="line">p1.run = types.MethodType(run, p1)</span><br><span class="line">p1.run()</span><br></pre></td></tr></table></figure></p>
<p>18、限制class实例添加的属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Person(object):</span><br><span class="line">    __slots__ = (&quot;name&quot;, &quot;age&quot;)</span><br><span class="line">p = Person()</span><br><span class="line">p.name = &quot;老王&quot;</span><br><span class="line">p.age = 20</span><br><span class="line">p.score = 100 #会报错！！！</span><br><span class="line">``` </span><br><span class="line">## 生成器、迭代器、装饰器、闭包（重点）！！</span><br><span class="line">19、生成器</span><br></pre></td></tr></table></figure></p>
<p>In [1]: a = [x*2 for x in range(10)]<br>In [2]: a<br>Out[2]: [0, 2, 4, 5, 6, 10, 12, 14, 16, 18]</p>
<p>#如果用[]，会生成数组，同时加载到内存中</p>
<p>#如果用括号（），输出的是一个地址，需要时才提取出<br>In [3]: b = (x*2 for x in range(10))<br>In [4]: b<br>Out[4]: &lt;generator object <genexpr> at 0x7fb057ff06d0&gt;<br>In [5]:next(b)<br>Out[5]:0<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20、a，b交换</span><br></pre></td></tr></table></figure></genexpr></p>
<p>def creatNum():<br>    print(“—-start—-“)<br>    a, b = 0, 1<br>    for i in range(5):<br>        print(“—-1—-“)<br>        yield b #python中有一个非常有用的语法叫做生成器，所利用到的关键字就是yield。有效利用生成器这个工具可以有效地节约系统资源，避免不必要的内存占用。当执行到这的时候，会做停顿。<br>        print(“—-2—-“)<br>        a, b = b, a+b<br>        print(“—-3—-“)<br>    print(“—-stop—-“)</p>
<p>#创建了一个生成器对象<br>a = creatNum()</p>
<p>#实现交换<br>a, b = 0, 1<br>a, b = b, a<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">21、斐波拉契数列</span><br></pre></td></tr></table></figure></p>
<p>a,b = 0, 1<br>a,b = b, a+b #重复此步骤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">22、类当做装饰器</span><br></pre></td></tr></table></figure></p>
<p>#1<br>class Test(object):<br>    def <strong>call</strong>(self):<br>        print(“—test—“)<br>t = Test()<br>t()</p>
<p>#out: —test—</p>
<p>#2<br>class Test(object):<br>    def <strong>init</strong>(self, func):<br>        print(‘—初始化—‘)<br>        print(‘func name is %s’func.<strong>name</strong>)<br>        self.<strong>func = func<br>    def </strong>call__(self):<br>        print(‘—装饰器中的功能—‘)<br>        self.__func()</p>
<p>@Test  #相当于 t = Test(test)<br>def test():<br>    print(‘—test—‘)</p>
<p>#out: —初始化—</p>
<p>#out:func name is ‘test’</p>
<p>test()</p>
<p>#out: —装饰器中的功能</p>
<p>#out:—test—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">23、元类</span><br></pre></td></tr></table></figure></p>
<p>Test = type(“Test”, (), {})#相当于创建一个类<br>Test</p>
<p>#out:__main.Test</p>
<p>#创建一个拥有属性num=0的Person类<br>Person = type(“Person”,(),{“num”:0})</p>
<p>#创建一个拥有方法printNum()的Test3类<br>def printNum(self):<br>    print(“–num-%d–”%self.num)<br>Test3 = type(“Test3”,(),{“printNum”:printNum})</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">#设置Foo类的属性变大写！！，通过metaclass设置</span><br><span class="line">def upper_attr(future_class_name, future_class_parents, future_class_attr):</span><br><span class="line">                #Foo                object                &#123;bar:&quot;bip&quot;&#125;</span><br><span class="line">    #遍历属性字典，把不是__开头的属性名字变成大写</span><br><span class="line">    newAttr = &#123;&#125;</span><br><span class="line">    for name, value in future_class_attr.items():</span><br><span class="line">        if not name.startswith(&quot;__&quot;):</span><br><span class="line">            newAttr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">    #调用type创建一个类</span><br><span class="line">    return type(future_class_name,future_class_parents,newAttr)</span><br><span class="line"></span><br><span class="line">class Foo(object,metaclass=upper_attr):</span><br><span class="line">  #  __metaclass__ = upper_attr #设置Foo类的元类为upper_attr  python2</span><br><span class="line">    bar = &quot;bip&quot;</span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &quot;bar&quot;))</span><br><span class="line">print(hasattr(Foo, &quot;BAR&quot;))</span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br><span class="line"></span><br><span class="line">#out:False</span><br><span class="line">#out:True</span><br><span class="line">#out:bip</span><br></pre></td></tr></table></figure>
<p>24、内建属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class Itcast(object):</span><br><span class="line">    def __init__(self,subject1):</span><br><span class="line">        self.subject1 = subject1</span><br><span class="line">        self.subject2 = &apos;cpp&apos;</span><br><span class="line">    #属性访问时拦截器，打log</span><br><span class="line">    def __getattribute__(self,obj): #obj--&gt;&quot;subject1&quot;</span><br><span class="line">        if obj == &apos;subject1&apos;:</span><br><span class="line">            print(&apos;log subject1&apos;)</span><br><span class="line">            return &apos;redirect python&apos;</span><br><span class="line">        else:</span><br><span class="line">            return object__getattribute__(self,obj)</span><br><span class="line">    </span><br><span class="line">    def show(self):</span><br><span class="line">        print(&apos;this is Itcast&apos;)</span><br><span class="line">        </span><br><span class="line">s = Itcast(&quot;python&quot;)</span><br><span class="line">print(s.subject1)</span><br><span class="line">print(s.subject2)</span><br></pre></td></tr></table></figure></p>
<h2 id="内建方法"><a href="#内建方法" class="headerlink" title="内建方法"></a>内建方法</h2><p>25、lambda之map<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#函数需要一个参数</span><br><span class="line">map(lambda x: x*x, [1, 2,3])</span><br><span class="line">#结果为：[1, 4, 9]</span><br><span class="line"></span><br><span class="line">#函数需要两个参数</span><br><span class="line">map(lambda x, y: x+y, [1, 2, 3], [4, 5, 6])</span><br><span class="line">#结果为:[5,7,9]</span><br><span class="line"></span><br><span class="line">def f1(x, y):</span><br><span class="line">    return (x, y)</span><br><span class="line">l1 = [0,1,2,3,4,5,6]</span><br><span class="line">l2 = [&apos;Sun&apos;, &apos;M&apos;, &apos;T&apos;, &apos;W&apos;, &apos;T&apos;, &apos;F&apos;, &apos;S&apos;]</span><br><span class="line">l3 = map(f1, l1, l2)</span><br><span class="line">print(list(l3))</span><br><span class="line">结果为：[(0,&apos;Sun&apos;), (1,&apos;M&apos;).....]</span><br></pre></td></tr></table></figure></p>
<p>26、lambda之filter<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fliter(lambda x : x%2, [1, 2 ,3, 4]) #如果为1，则输出</span><br><span class="line">[1, 3]</span><br><span class="line"></span><br><span class="line">filter(None, &quot;she&quot;)</span><br><span class="line">&apos;she&apos;</span><br></pre></td></tr></table></figure></p>
<p>27、lambda之reduce<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">reduce(lambda x, y: x+y, [1,2,3,4])</span><br><span class="line">10 #先把1赋值给x，2赋值给2，x+y后=3，把3赋值给x，数组中的3赋值给y，再累加，以此类推</span><br><span class="line"></span><br><span class="line">reduce(lambda x, y:x+y, [1,2,3,4], 5)</span><br><span class="line">15 #如果前面是数组，先把5赋值给x，再累加[1,,2,3,4]</span><br><span class="line"></span><br><span class="line">reduce(lambda x, y: x+y, [&apos;aa&apos;, &apos;bb&apos;, &apos;cc&apos;], &apos;dd&apos;)</span><br><span class="line">ddaabbcc</span><br></pre></td></tr></table></figure></p>
<p>28、sort<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [9,8,7,6,5,4,3,2,1]</span><br><span class="line">a.sort()</span><br><span class="line">a</span><br><span class="line">#[1,2,3,4,5,6,7,8,9]</span><br><span class="line"></span><br><span class="line">b = [&apos;dd&apos;,&apos;cc&apos;,&apos;bb&apos;,&apos;aa&apos;]</span><br><span class="line">b.sort()</span><br><span class="line">b</span><br><span class="line">#[&apos;aa&apos;,&apos;bb&apos;,&apos;cc&apos;,&apos;dd&apos;]</span><br></pre></td></tr></table></figure></p>
<p>28、python的functools包中提供了一个叫wraps的装饰器来消除这样的副作用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import functools</span><br><span class="line">def note(func):</span><br><span class="line">    &quot;note function&quot;</span><br><span class="line">    @functoolswraps(func)</span><br><span class="line">    def wrapper():</span><br><span class="line">        &quot;wrapper function&quot;</span><br><span class="line">        print(&quot;note something&quot;)</span><br><span class="line">        return func()</span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line">@note</span><br><span class="line">def test():</span><br><span class="line">    &quot;test function&quot;</span><br><span class="line">    print(&apos;I am test&apos;)</span><br><span class="line"></span><br><span class="line">test()</span><br><span class="line">print(test.__doc__)</span><br></pre></td></tr></table></figure></p>

    
        <div class="post-more-div">
            <a href="/posts/undefined/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
    </ul>

    

</div>

        <footer class="footer">
    <div class="footer-content">
        <span class="power">
            <i class="icon icon-lg icon-copyright"></i>
            2019
            <i class="icon icon-lg icon-heart"></i>
            <a href="https://xifujiang.github.io">xifuxili.com.cn</a>
            <br>
            Power by
            <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>&nbsp;·&nbsp;
            Theme
            <a class="tomotoeslink" href="https://github.com/tomotoes/hexo-theme-tomotoes/" target="_blank" rel="external nofollow">tomotoes</a>
        </span>

        <br>

        <span id="RunTime" style="color:#a7a7a2;"></span>
        <br>

        <span>
            
	<i class="icon icon-lg icon-user">
<span id="busuanzi_container_site_uv" style="display:none">
       访问用户：<span id="busuanzi_value_site_uv"></span>
    </span>人</i>
    ·
    <i class="icon icon-lg icon-eye">
    <span id="busuanzi_container_site_pv" style="display:none">
      访问次数：<span id="busuanzi_value_site_pv"></span>
    </span>次
    </i>


        </span>
        <br>

        <span class="license"><a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">博客内容遵循 知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
    </div>
</footer>

    </main>
    
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <!-- waves按钮特效 -->
<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<!-- 主题配置脚本 -->
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };
</script>

<!-- jquery -->
<script src="/js/jquery.min.js?v=3.0"></script>

<!-- 搜索 -->

<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item waves-block waves-effect" onclick="location.href='{path}'">
    <div class="title ellipsis" title="{title}">{title}</div>
</li>
</template>


<!-- main博客脚本 -->
<script src="/js/main.min.js?v=3.0"></script>

<!-- 动画&配置 -->
<script src="/js/script.min.js?v=3.0"></script>

<!-- 脚本管理 -->
<script>

if(window.innerWidth > 800){
	/* 3D标题 */
	$(".content-header").on("mousemove", threedee);

	/* 底部追随鼠标 */
	$(".footer").hover(2);

	/* gotop键的涟漪 */
	$("#gotop").hover(1);

	/* 赞赏的粒子雨 */
	$("#reward").hover(3);

	/* 微信公众号的底部渲染 */
	$("#wechat").hover(4);

    /* 标题跳动 */
    $(".archivestitle").bumpyText();

	/* 图片点击放大 */
	const postimg = jQuery(".post-content img:not(.github-emoji)");
	postimg.on("click",function(){

		mask.classList.add("in");
		main.classList.add("Mask");
		menu.classList.add("Mask");
		var myimg = this.cloneNode(true);
		myimg.classList.add("imgShow");

		setTimeout(function(){
			jQuery(myimg).animate({
				opacity:"1"
			},1000);
		},0);

		document.body.appendChild(myimg);

		myimg.onclick=function(){
			document.body.removeChild(myimg);
			mask.classList.remove("in");
			main.classList.remove("Mask");
			menu.classList.remove("Mask");
		};

	});

}

/* 名字跳动 */
$("#name").bumpyText();


/* 网站运行时间 */
setInterval(function () {
	setTime("2019/04/29");
}, 1000);

/* 文章块的淡出 */
postshow();

/* 座右铭 */

   getHitokoto();



/* 粘贴提示 */
G($(".post-content"), location.href, "xifujiang");


/* 控制台 */
if (window.console && window.console.log) {
	setTimeout(function () {
		console.log("\n %c 倔强小西芙 %c  © Xifu Mua~  https://weibo.com/xifujiang \n\n", "color:#FFFFFB;background:#1abc9c;padding:5px 0;border-radius:.5rem 0 0 .5rem;", "color:#FFFFFB;background:#080808;padding:5px 0;border-radius:0 .5rem .5rem 0;");
	}, 0);
}

</script>




<!-- 公式渲染 -->



<!-- 不蒜子 -->

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</body>
</html>
